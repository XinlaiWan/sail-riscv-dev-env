#define TEST_VMRE1_OP( testnum, inst, result_base, base ) \
        TEST_CASE_LOOP( testnum, v16, result_base, \
            li x1, 8; \
            vsetvli x31, x1, e64, m4, tu, mu; \
            la  x1, base; \
            vl8re64.v v8, (x1);  \
            inst v16, v8; \
        ) 
#define TEST_VMRE2_OP( testnum, inst, result_base1, result_base2, base ) \
        TEST_CASE_LOOP( testnum, v16, result_base1, \
            li x1, 16; \
            vsetvli x31, x1, e64, m4, tu, mu; \
            la  x1, base; \
            vl8re64.v v8, (x1);  \
            inst v16, v8; \
        ) \


#define TEST_VMRE4_OP( testnum, inst, result_base1, result_base2, base ) \
        TEST_CASE_LOOP( testnum, v16, result_base1, \
            li x1, 32; \
            vsetvli x31, x1, e64, m4, tu, mu; \
            la  x1, base; \
            vl8re64.v v8, (x1);  \
            inst v16, v8; \
        ) \


#define TEST_VMRE8_OP( testnum, inst, result_base1, result_base2, base ) \
        TEST_CASE_LOOP( testnum, v16, result_base1, \
            li x1, 64; \
            vsetvli x31, x1, e64, m4, tu, mu; \
            la  x1, base; \
            vl8re64.v v8, (x1);  \
            inst v16, v8; \
        ) \


#----------------------------------------------------------------------------- 
    # vmre.S
    #-----------------------------------------------------------------------------
    #
    # Test vmre instructions.
    #

    #include "model_test.h"
    #include "arch_test.h"
    #include "riscv_test.h"
    #include "test_macros_vector.h"

RVTEST_ISA("RV64RV64IMAFDCVZicsr")
    
    .section .text.init
    .globl rvtest_entry_point
    rvtest_entry_point:
    
    #ifdef TEST_CASE_1
    
    RVTEST_CASE(0,"//check ISA:=regex(.*64.*);check ISA:=regex(.*V.*);def TEST_CASE_1=True;",vmre)
    
    RVTEST_RV64UV
    RVMODEL_BOOT
    RVTEST_CODE_BEGIN
    RVTEST_VSET
    
  #-------------------------------------------------------------
  # vmre tests
  #-------------------------------------------------------------
TEST_VMRE1_OP( 2,  vmv1r.v, walking_data0, walking_data0);
TEST_VMRE2_OP( 3,  vmv2r.v, walking_data0, walking_data1, walking_data0 );
TEST_VMRE4_OP( 4,  vmv4r.v, walking_data0, walking_data3, walking_data0 );
TEST_VMRE8_OP( 5,  vmv8r.v, walking_data0, walking_data7, walking_data0 );
TEST_VMRE1_OP( 7,  vmv1r.v, walking_data1, walking_data1);
TEST_VMRE2_OP( 8,  vmv2r.v, walking_data1, walking_data2, walking_data1 );
TEST_VMRE4_OP( 9,  vmv4r.v, walking_data1, walking_data4, walking_data1 );
TEST_VMRE8_OP( 10,  vmv8r.v, walking_data1, walking_data8, walking_data1 );
TEST_VMRE1_OP( 12,  vmv1r.v, walking_data2, walking_data2);
TEST_VMRE2_OP( 13,  vmv2r.v, walking_data2, walking_data3, walking_data2 );
TEST_VMRE4_OP( 14,  vmv4r.v, walking_data2, walking_data5, walking_data2 );
TEST_VMRE8_OP( 15,  vmv8r.v, walking_data2, walking_data9, walking_data2 );
  RVTEST_SIGBASE( x20,signature_x20_2)
        
    TEST_VV_OP_NOUSE(32766, vadd.vv, 2, 1, 1)
    TEST_PASSFAIL
    #endif
    
    RVTEST_CODE_END
    RVMODEL_HALT
    
    .data
    RVTEST_DATA_BEGIN
    
    TEST_DATA
    
    
walking_data0:
.dword	-5164909090926207223
.dword	3779926684543803515
.dword	7959195098838596965
.dword	5327910593403953846
.dword	-8393950402782620586
.dword	5424512104520550131
.dword	-1603801040442653376
.dword	7114806754597192110
.dword	4422401381934366650
.dword	7282259478166565129
.dword	-3542261981228958617
.dword	129277612745151919
.dword	8315100020083683455
.dword	-8492593917539101945
.dword	3155034520839818709
.dword	4163936635021877274
.dword	-5045145229368104143
.dword	-1110932158969159891
.dword	-3129104659206023942
.dword	2468666855888552930
.dword	2070034682790846159
.dword	1383469843981816052
.dword	-277534130414523331
.dword	-2048233734863339033
.dword	4550339224515426292
.dword	-1979910346613881074
.dword	-5385789144694485773
.dword	7068824374990472992
.dword	8959478423106919606
.dword	176007262131243533
.dword	-1854209335283560626
.dword	-1885763166985639346

walking_data1:
.dword	-3353348821438290772
.dword	-9091256609072007225
.dword	-4285260197586706294
.dword	-789290026906223444
.dword	-7606302210873388852
.dword	-1954708071248510514
.dword	7723078421326312600
.dword	-4702789098964091575
.dword	433062305570219061
.dword	6019314724560649747
.dword	-6806445240392462895
.dword	-1564145704045451407
.dword	-9070961849132065619
.dword	-4926336677549589500
.dword	-5946246512638181144
.dword	-628547417011635590
.dword	-1265990569410767910
.dword	-797546467194667240
.dword	-3872626542645790586
.dword	8577701703825082359
.dword	-6619145812974760231
.dword	8590968156245133566
.dword	2657933746178862337
.dword	6528655229891749895
.dword	6939517587177378920
.dword	-2743330070392173661
.dword	8348197567574398124
.dword	-6762184915733634482
.dword	1979446455747389145
.dword	4424484673992679785
.dword	-6024492713283732099
.dword	8052599149948573691

walking_data2:
.dword	8537687549473565120
.dword	-8443592978525420147
.dword	7564357401535533060
.dword	2362910361034913669
.dword	-4235478809621820057
.dword	5514246200741415802
.dword	-3906621596457819530
.dword	-1150699973491409691
.dword	-6799673804699669256
.dword	6585062641027866671
.dword	7300009590632741029
.dword	-1563251399560137436
.dword	4103969783584148138
.dword	1668730350842008274
.dword	979001561858787179
.dword	-8208089511931517688
.dword	8726663616719222760
.dword	-6006423313522000877
.dword	-5920953130457537824
.dword	650782609206542933
.dword	8141242405204842664
.dword	-8429117356691548595
.dword	5513546194616336921
.dword	-8215330732845094045
.dword	-2070375091013269131
.dword	-822501955704951138
.dword	4489035541250873921
.dword	819657487682586427
.dword	372131956144801369
.dword	4338168216119636150
.dword	-5853986475354828347
.dword	-7778198644282400573

walking_data3:
.dword	8584560888685190954
.dword	1578081380214166955
.dword	-4827930570017560764
.dword	6226989138013160354
.dword	9048101570152788712
.dword	821594385231065021
.dword	777231152414133239
.dword	-967150195265189675
.dword	-1271039442271983824
.dword	4630295518070315477
.dword	-5034699855373088439
.dword	6662169474291239142
.dword	-8801446893246968989
.dword	-191827888758893120
.dword	5213402630375493499
.dword	-7286014201834899116
.dword	-6060357732746658130
.dword	-702352369914065765
.dword	-8237481888427686026
.dword	-5634712340044904686
.dword	-6602128827306627830
.dword	-7491992475103344990
.dword	-8626782384788547111
.dword	1466906993769588788
.dword	8099481407689848276
.dword	-2503977131330013233
.dword	2197689194152554491
.dword	-6661524450687187511
.dword	-1003096766375439605
.dword	3002728032082716441
.dword	5130238539926688752
.dword	5187253542535535558

walking_data4:
.dword	-3929411031236192000
.dword	-4731665177287011404
.dword	3647211840930648156
.dword	6767480978710727476
.dword	-3774322813816125101
.dword	102236727046980199
.dword	-1060319414751111039
.dword	181875569581399037
.dword	4448713846908618333
.dword	-935527361105839775
.dword	4827690479227294089
.dword	27531432676540751
.dword	6349921157842909244
.dword	2022913832287525747
.dword	6016453365664560268
.dword	5349970260930021155
.dword	-4374423895930330069
.dword	6899615058906044742
.dword	-6284415359514415284
.dword	-2007669612892430482
.dword	-1490320761536574766
.dword	-5215234747513632353
.dword	7176034538880814996
.dword	4029907887828409614
.dword	-7470842734585059695
.dword	1661951244551985897
.dword	-1621534292701717590
.dword	-4763422895477351990
.dword	846274328610381830
.dword	8640065104041360904
.dword	3324832161200834560
.dword	-7669180190804290509

walking_data5:
.dword	-2132467306563206637
.dword	8088961029193592886
.dword	-8842405675437439641
.dword	-4464187825917616919
.dword	203743641545006366
.dword	680060358841962990
.dword	-8523444180836852111
.dword	482390213432679565
.dword	-8193889171162895633
.dword	-5409274372673396964
.dword	4222548331565514670
.dword	-4895539602970809466
.dword	-3698729580050672511
.dword	-1607306149857197214
.dword	2032675936295606250
.dword	6548184203196408647
.dword	-708745462495623978
.dword	-7294692643292481038
.dword	1479209345637522956
.dword	-4080789229993211555
.dword	-4163423836406162566
.dword	8460879337970224657
.dword	4658047297522960897
.dword	4532433968298778118
.dword	-5866323621779086791
.dword	8316657615715479699
.dword	-498355929133573038
.dword	-7737449466387052974
.dword	-5516140578846765235
.dword	-3815568866195492008
.dword	8171368757510796219
.dword	179668338607821058

walking_data6:
.dword	-3087876376958698283
.dword	5282590384544900212
.dword	-8737867429397398442
.dword	-6898596348636786358
.dword	-4911608313470390949
.dword	2815633642359293423
.dword	-1170703347644193349
.dword	-6439601698392927439
.dword	-421456612882427011
.dword	3700455565881893687
.dword	-9195859351346532882
.dword	-4761954556809969061
.dword	3971309213968234821
.dword	-9206780689547354828
.dword	-1629581726040779036
.dword	-4285151367092694786
.dword	4903260797691898188
.dword	7607362175698354251
.dword	3771466192359474524
.dword	1135197345210320659
.dword	7944059443916781055
.dword	-3247714453966392493
.dword	3307776274278051654
.dword	6459284696756959044
.dword	2386826617266505217
.dword	5081647368880480280
.dword	8451369766423911246
.dword	-8578011805240756332
.dword	-6882502151128976734
.dword	3455703954319942486
.dword	6545958449226543304
.dword	-8802535926298165222

walking_data7:
.dword	-9100147421886742540
.dword	-4849894415944373417
.dword	1404210955629505137
.dword	8800547635991222920
.dword	5746538063639325766
.dword	1534309930069192547
.dword	-5906094473946435570
.dword	8014311109722362591
.dword	-845588781459802567
.dword	-8533247077463457979
.dword	2231762074948193024
.dword	-3914126032041395095
.dword	-7075837724313379989
.dword	7304750722199332883
.dword	-3064032901118246207
.dword	-6736061239176283152
.dword	-5182918128506826929
.dword	-6525552243363903457
.dword	9216053620309774824
.dword	-8030280840311268135
.dword	-233536837229631650
.dword	5138932819660960288
.dword	-5463721488845516625
.dword	4978603897694321959
.dword	6373393494094993082
.dword	9094349666675764180
.dword	-5508593832800812089
.dword	-6509207350578527549
.dword	6100712331988596521
.dword	-2307640060336938683
.dword	-4438835677479443577
.dword	1679885453792964066

walking_data8:
.dword	5370324195601220114
.dword	8653568338515767440
.dword	-3488442973447410518
.dword	8800992304525226769
.dword	-1488203560969233009
.dword	821123094630923264
.dword	-6836876647969570747
.dword	9092543776066054057
.dword	-6463699474156760332
.dword	3601342994512672816
.dword	4061849139546430415
.dword	1581842058386929837
.dword	-7844081415753849713
.dword	-4728951830907942679
.dword	-3543214560474302482
.dword	-7359502519005085363
.dword	7066275246615871260
.dword	-5177385903088231688
.dword	4026131408098330316
.dword	-4201399459107367051
.dword	-1077858321687967854
.dword	-6157018796760694933
.dword	-6995781426790248681
.dword	8125419579891199858
.dword	6924313472778393813
.dword	-3407303371120590207
.dword	8402967415897184490
.dword	-7906647958301305550
.dword	-3892462532912647634
.dword	5328801599972107325
.dword	3206453635580891871
.dword	4132352335454332552

walking_data9:
.dword	-5752571853584074933
.dword	7672299553381915884
.dword	-8345196508589966468
.dword	-7564873075775896117
.dword	5548501874970787606
.dword	2062186065903650846
.dword	-7776304662637393884
.dword	-5338401384509700456
.dword	4656445981007064401
.dword	1540234336573331253
.dword	2421765782489290857
.dword	68831469075879540
.dword	6840484337977579392
.dword	9131888959993571384
.dword	8841012386527351492
.dword	6751579493934232721
.dword	-8235694734240400648
.dword	4428802053572836398
.dword	2645693347709344674
.dword	-4291604125082684975
.dword	-892586749446938175
.dword	2077515281610960262
.dword	5316158881787124082
.dword	74931840224853228
.dword	-4131460273594619416
.dword	2814572748559383917
.dword	-6647417549181834486
.dword	-713730743098549509
.dword	-74895529615983845
.dword	7598703126414962167
.dword	-4935413050882000928
.dword	6738573782817535842

walking_data10:
.dword	-6571464102151853304
.dword	-4638675050220762276
.dword	2037531135518754537
.dword	1502165730257914494
.dword	-6801026398171624015
.dword	2336946972676929954
.dword	-3832955931227324017
.dword	-8836168686962828381
.dword	-3388414442170631993
.dword	3135165691737927610
.dword	8158845293590539389
.dword	-3063592410901617347
.dword	-4221527573641986935
.dword	6273604607164562360
.dword	-1004474055471218286
.dword	2484739756352100678
.dword	-271340975439325208
.dword	-1688438036255114793
.dword	-5968143312051324049
.dword	2836733154063514128
.dword	645735079111549893
.dword	-2168900817561239405
.dword	1137047514301736569
.dword	-597419107592121463
.dword	2032039323456550545
.dword	8824158675326359559
.dword	7893177123738993479
.dword	-1567976392757918092
.dword	4529389878180886281
.dword	7399075107162578266
.dword	7977687456146760069
.dword	-7333409565305307141

walking_data11:
.dword	6903857275243896654
.dword	6792579500595256557
.dword	-7472255445790541043
.dword	-8803675142275360038
.dword	4323509277772452056
.dword	9183264204246422435
.dword	8259518820357411373
.dword	7252526973744165209
.dword	3758786366802602969
.dword	-6760508746132845057
.dword	698355059767314664
.dword	788645706787514288
.dword	1116634549625999642
.dword	6183994588687288294
.dword	7297217122669594925
.dword	-3883401397032038220
.dword	-7162253901862204986
.dword	3968510548320856987
.dword	679654207957238727
.dword	6135265741931833242
.dword	-7368727539502822727
.dword	-3941473834016263136
.dword	-769500296133309160
.dword	3582592652983158457
.dword	-8862029626320332265
.dword	-5814206984977565377
.dword	-6533606671752381094
.dword	-7194310769465304492
.dword	1031480933333746832
.dword	-6544918191194245008
.dword	238292691969507932
.dword	-6469079168481809995

signature_x12_0:
        .fill 0,4,0xdeadbeef
    
    
    signature_x12_1:
        .fill 32,4,0xdeadbeef
    
    
    signature_x20_0:
        .fill 512,4,0xdeadbeef
    
    
    signature_x20_1:
        .fill 512,4,0xdeadbeef
    
    
    signature_x20_2:
        .fill 376,4,0xdeadbeef
    
    #ifdef rvtest_mtrap_routine
    
    mtrap_sigptr:
        .fill 128,4,0xdeadbeef
    
    #endif
    
    #ifdef rvtest_gpr_save
    
    gpr_save:
        .fill 32*(XLEN/32),4,0xdeadbeef
    
    #endif
    
    RVTEST_DATA_END
    
